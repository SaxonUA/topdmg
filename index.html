<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<title>WOT Max Damage Platoon</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    body {
        background: transparent !important;
        font-family: 'Segoe UI', 'Roboto', 'Arial Narrow Bold', sans-serif;
        color: #fff;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        padding: 10px;
    }

    .widget {
        width: 620px;
        background: linear-gradient(145deg, 
            rgba(26, 26, 46, 0.85) 0%, 
            rgba(15, 15, 26, 0.85) 100%);
        backdrop-filter: blur(12px) saturate(180%);
        -webkit-backdrop-filter: blur(12px) saturate(180%);
        border-radius: 18px;
        padding: 20px;
        box-shadow: 
            0 15px 35px rgba(0, 0, 0, 0.8),
            inset 0 1px 0 rgba(255, 255, 255, 0.1);
        border: 2px solid rgba(255, 107, 0, 0.4);
        position: relative;
        overflow: hidden;
        opacity: 0.95;
    }

    .widget::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(90deg, 
            #ff6b00 0%, 
            #ffd166 50%, 
            #ff6b00 100%);
        z-index: 2;
        box-shadow: 0 0 15px rgba(255, 107, 0, 0.7);
    }

    .header {
        text-align: center;
        margin-bottom: 25px;
    }

    .title {
        font-size: 2.2rem !important;
        font-weight: 900;
        background: linear-gradient(90deg, #ff6b00, #ffd166);
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
        letter-spacing: 1.5px;
        text-transform: uppercase;
        text-shadow: 
            0 2px 10px rgba(0, 0, 0, 0.8),
            0 0 20px rgba(255, 107, 0, 0.5);
        padding: 5px 0;
    }

    .players-container {
        display: flex;
        justify-content: space-between;
        align-items: stretch;
        gap: 20px;
        margin-bottom: 25px;
    }

    .player-card {
        flex: 1;
        background: rgba(30, 30, 45, 0.9);
        border-radius: 16px;
        padding: 20px;
        transition: all 0.3s ease;
        position: relative;
        border: 2px solid rgba(255, 255, 255, 0.08);
        display: flex;
        flex-direction: column;
        backdrop-filter: blur(5px);
    }

    .player-card.winner {
        border-color: #ff6b00;
        background: rgba(40, 30, 30, 0.95);
        box-shadow: 
            0 0 35px rgba(255, 107, 0, 0.6),
            inset 0 0 20px rgba(255, 107, 0, 0.2);
        transform: translateY(-5px);
    }

    .player-card.winner::after {
        content: 'üèÜ';
        position: absolute;
        top: -18px;
        left: 50%;
        transform: translateX(-50%);
        font-size: 1.8rem;
        z-index: 3;
        filter: drop-shadow(0 2px 5px rgba(0,0,0,0.8));
    }

    .player-header {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 15px;
        margin-bottom: 20px;
    }

    .player-avatar {
        width: 55px;
        height: 55px;
        background: linear-gradient(135deg, #2a2a4a, #1a1a2e);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.8rem;
        color: #ffd166;
        border: 3px solid rgba(255, 255, 255, 0.15);
        flex-shrink: 0;
        overflow: hidden;
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
        box-shadow: 0 4px 12px rgba(0,0,0,0.5);
    }

    .player-info h2 {
        font-size: 1.8rem !important;
        font-weight: 900;
        color: #ffffff;
        text-align: center;
        text-shadow: 
            0 2px 8px rgba(0, 0, 0, 0.9),
            0 0 15px rgba(255, 255, 255, 0.1);
        letter-spacing: 0.5px;
    }

    .damage-section {
        text-align: center;
        margin-bottom: 20px;
        flex-grow: 1;
        display: flex;
        flex-direction: column;
        justify-content: center;
        padding: 15px 0;
    }

    .damage-value {
        font-size: 5rem !important;
        font-weight: 900;
        color: #ff6b00;
        text-shadow: 
            0 3px 20px rgba(255, 107, 0, 0.8),
            0 0 30px rgba(255, 107, 0, 0.6),
            2px 2px 0 rgba(0, 0, 0, 0.8);
        line-height: 1;
        margin-bottom: 10px;
        letter-spacing: -1px;
    }

    .damage-label {
        font-size: 1.2rem !important;
        color: #cbd5e1;
        text-transform: uppercase;
        letter-spacing: 1px;
        font-weight: 700;
        text-shadow: 0 2px 4px rgba(0,0,0,0.8);
    }

    .stats-section {
        display: flex;
        flex-direction: column;
        gap: 12px;
        margin-top: 15px;
    }

    .top-stats {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
    }

    .stat-item {
        display: flex;
        flex-direction: column;
        padding: 12px;
        background: rgba(20, 20, 35, 0.8);
        border-radius: 10px;
        align-items: center;
        justify-content: center;
        border: 1px solid rgba(255, 255, 255, 0.05);
        backdrop-filter: blur(4px);
    }

    .stat-label {
        font-size: 0.95rem !important;
        color: #94a3b8;
        margin-bottom: 6px;
        display: flex;
        align-items: center;
        gap: 6px;
        font-weight: 600;
        text-shadow: 0 1px 3px rgba(0,0,0,0.8);
    }

    .stat-label i {
        font-size: 0.9rem;
    }

    .stat-value {
        font-size: 2rem !important;
        font-weight: 900;
        color: #ffffff;
        text-shadow: 
            0 2px 10px rgba(0, 0, 0, 0.9),
            0 0 15px rgba(255, 255, 255, 0.1);
        letter-spacing: 0.5px;
    }

    .tank-row {
        padding: 15px;
        background: rgba(20, 20, 35, 0.9);
        border-radius: 10px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        min-height: 60px;
        border-top: 3px solid #06d6a0;
        border-left: 1px solid rgba(6, 214, 160, 0.3);
        border-right: 1px solid rgba(6, 214, 160, 0.3);
        border-bottom: 1px solid rgba(6, 214, 160, 0.3);
        box-shadow: 0 5px 15px rgba(0,0,0,0.4);
    }

    .tank-label {
        font-size: 0.95rem !important;
        color: #94a3b8;
        margin-bottom: 8px;
        display: flex;
        align-items: center;
        gap: 6px;
        font-weight: 600;
        text-shadow: 0 1px 3px rgba(0,0,0,0.8);
    }

    .tank-value {
        font-size: 1.8rem !important;
        font-weight: 900;
        color: #06d6a0;
        text-align: center;
        font-style: italic;
        text-shadow: 
            0 2px 10px rgba(6, 214, 160, 0.6),
            0 0 15px rgba(6, 214, 160, 0.3),
            1px 1px 0 rgba(0, 0, 0, 0.8);
        letter-spacing: 0.5px;
    }

    .vs-container {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 40px;
        flex-shrink: 0;
    }

    .vs {
        background: rgba(255, 255, 255, 0.15);
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 900;
        font-size: 1.2rem;
        color: #ffd166;
        border: 3px solid rgba(255, 255, 255, 0.2);
        text-shadow: 0 2px 5px rgba(0,0,0,0.8);
        box-shadow: 0 4px 12px rgba(0,0,0,0.6);
        backdrop-filter: blur(5px);
    }

    .platoon-stats {
        background: rgba(25, 25, 40, 0.95);
        border-radius: 14px;
        padding: 20px;
        margin-top: 20px;
        border-left: 4px solid #06d6a0;
        box-shadow: 
            0 8px 25px rgba(0, 0, 0, 0.6),
            inset 0 1px 0 rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(8px);
    }

    .platoon-stats h3 {
        color: #06d6a0;
        font-size: 1.4rem !important;
        margin-bottom: 20px;
        display: flex;
        align-items: center;
        gap: 10px;
        text-shadow: 0 2px 8px rgba(0,0,0,0.8);
        font-weight: 800;
    }

    .platoon-stats h3 i {
        font-size: 1.3rem;
    }

    .stats-grid {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 15px;
    }

    .stat-card {
        background: rgba(35, 35, 55, 0.9);
        border-radius: 12px;
        padding: 18px 12px;
        text-align: center;
        transition: transform 0.3s, box-shadow 0.3s;
        border: 1px solid rgba(255, 255, 255, 0.08);
        backdrop-filter: blur(5px);
    }

    .stat-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.4);
    }

    .stat-card .value {
        font-size: 2.8rem !important;
        font-weight: 900;
        color: #ffd166;
        margin-bottom: 8px;
        text-shadow: 
            0 3px 15px rgba(255, 209, 102, 0.7),
            0 0 20px rgba(255, 209, 102, 0.4),
            2px 2px 0 rgba(0, 0, 0, 0.8);
        letter-spacing: 0.5px;
    }

    .stat-card .label {
        color: #cbd5e1;
        font-size: 1rem !important;
        text-transform: uppercase;
        letter-spacing: 1px;
        font-weight: 700;
        text-shadow: 0 2px 4px rgba(0,0,0,0.8);
    }

    /* –ê–Ω—ñ–º–∞—Ü—ñ—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö */
    @keyframes highlightUpdate {
        0% { transform: scale(1); }
        50% { transform: scale(1.05); }
        100% { transform: scale(1); }
    }

    .damage-value.updated {
        animation: highlightUpdate 0.5s ease;
    }
</style>
</head>

<body>
<div class="widget">
    <div class="header">
        <h1 class="title">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞ –®–∫–æ–¥–∞</h1>
    </div>

    <div class="players-container">
        <div id="p1" class="player-card">
            <div class="player-header">
                <div class="player-avatar" id="p1_avatar" style="background-image: url('https://saxonua.github.io/site/logo.png');">
                    <!-- –õ–æ–≥–æ—Ç–∏–ø –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î—Ç—å—Å—è —è–∫ —Ñ–æ–Ω -->
                </div>
                <div class="player-info">
                    <h2>SaXon</h2>
                </div>
            </div>

            <div class="damage-section">
                <div class="damage-value" id="p1_damage">0</div>
                <div class="damage-label">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞ —à–∫–æ–¥–∞</div>
            </div>

            <div class="stats-section">
                <div class="top-stats">
                    <div class="stat-item">
                        <div class="stat-label">
                            <i class="fas fa-crosshairs"></i>
                            <span>–°–µ—Ä–µ–¥–Ω—è —à–∫–æ–¥–∞</span>
                        </div>
                        <div class="stat-value" id="p1_avg_damage">0</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">
                            <i class="fas fa-skull"></i>
                            <span>–§—Ä–∞–≥–∏</span>
                        </div>
                        <div class="stat-value" id="p1_total_frags">0</div>
                    </div>
                </div>
                
                <div class="tank-row">
                    <div class="tank-label">
                        <i class="fas fa-flag"></i>
                        <span>–¢–∞–Ω–∫</span>
                    </div>
                    <div class="tank-value" id="p1_best_tank">-</div>
                </div>
            </div>
        </div>

        <div class="vs-container">
            <div class="vs">VS</div>
        </div>

        <div id="p2" class="player-card">
            <div class="player-header">
                <div class="player-avatar">
                    <i class="fas fa-helmet-battle"></i>
                </div>
                <div class="player-info">
                    <h2>Devil_484</h2>
                </div>
            </div>

            <div class="damage-section">
                <div class="damage-value" id="p2_damage">0</div>
                <div class="damage-label">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞ —à–∫–æ–¥–∞</div>
            </div>

            <div class="stats-section">
                <div class="top-stats">
                    <div class="stat-item">
                        <div class="stat-label">
                            <i class="fas fa-crosshairs"></i>
                            <span>–°–µ—Ä–µ–¥–Ω—è —à–∫–æ–¥–∞</span>
                        </div>
                        <div class="stat-value" id="p2_avg_damage">0</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">
                            <i class="fas fa-skull"></i>
                            <span>–§—Ä–∞–≥–∏</span>
                        </div>
                        <div class="stat-value" id="p2_total_frags">0</div>
                    </div>
                </div>
                
                <div class="tank-row">
                    <div class="tank-label">
                        <i class="fas fa-flag"></i>
                        <span>–¢–∞–Ω–∫</span>
                    </div>
                    <div class="tank-value" id="p2_best_tank">-</div>
                </div>
            </div>
        </div>
    </div>

    <div class="platoon-stats">
        <h3><i class="fas fa-users"></i> –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤–∑–≤–æ–¥—É</h3>
        <div class="stats-grid">
            <div class="stat-card">
                <div class="value" id="total_battles">0</div>
                <div class="label">–ë–æ—ó</div>
            </div>
            <div class="stat-card">
                <div class="value" id="win_rate">0%</div>
                <div class="label">Winrate</div>
            </div>
            <div class="stat-card">
                <div class="value" id="total_damage">0</div>
                <div class="label">–ó–∞–≥–∞–ª—å–Ω–∞ —à–∫–æ–¥–∞</div>
            </div>
            <div class="stat-card">
                <div class="value" id="total_platoon_frags">0</div>
                <div class="label">–ö-—Ç—å —Ñ—Ä–∞–≥—ñ–≤</div>
            </div>
        </div>
    </div>
</div>

<script>
const SHEET_ID = "17phnEn-NW-OnrZg4DcW65r-Xoq6ScsdVjS5yL0SS3fk";
const GID = "506446790";
const CSV_URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/export?format=csv&gid=${GID}`;

async function loadData() {
    try {
        const response = await fetch(CSV_URL);
        const text = await response.text();
        const rows = text.split("\n").slice(1);

        let maxSaXon = 0;
        let maxDevil = 0;
        let totalBattles = 0;
        let totalWins = 0;
        let totalDamage = 0;
        let totalFrags = 0;
        let saXonTotalDamage = 0;
        let devilTotalDamage = 0;
        let saXonTotalFrags = 0;
        let devilTotalFrags = 0;
        let saXonBestTank = '-';
        let devilBestTank = '-';

        rows.forEach((row, index) => {
            if (!row.trim()) return;
            
            const cols = row.split(",");
            if (cols.length < 9) return;

            const dmg1 = parseInt(cols[3]) || 0; // D - SaXon damage
            const dmg2 = parseInt(cols[4]) || 0; // E - Devil damage
            const frags1 = parseInt(cols[5]) || 0; // F - SaXon —Ñ—Ä–∞–≥–∏
            const frags2 = parseInt(cols[6]) || 0; // G - Devil —Ñ—Ä–∞–≥–∏
            const win = parseInt(cols[8]) || 0;  // I - Win (1) or Loss (0)
            const tank1 = cols[1] || '-'; // B - SaXon —Ç–∞–Ω–∫
            const tank2 = cols[2] || '-'; // C - Devil —Ç–∞–Ω–∫
            
            // Track max damage for SaXon
            if (dmg1 > maxSaXon) {
                maxSaXon = dmg1;
                saXonBestTank = tank1;
            }
            
            // Track max damage for Devil
            if (dmg2 > maxDevil) {
                maxDevil = dmg2;
                devilBestTank = tank2;
            }
            
            // Sum totals
            saXonTotalDamage += dmg1;
            devilTotalDamage += dmg2;
            totalDamage += dmg1 + dmg2;
            
            saXonTotalFrags += frags1;
            devilTotalFrags += frags2;
            totalFrags += frags1 + frags2;
            
            if (!isNaN(win)) {
                totalBattles++;
                totalWins += win;
            }
        });

        // Calculate winrate
        const winRate = totalBattles > 0 ? ((totalWins / totalBattles) * 100).toFixed(1) : "0.0";
        const avgSaXonDamage = totalBattles > 0 ? Math.round(saXonTotalDamage / totalBattles) : 0;
        const avgDevilDamage = totalBattles > 0 ? Math.round(devilTotalDamage / totalBattles) : 0;

        // Update UI with animation
        const animateUpdate = (element, newValue) => {
            const oldValue = element.textContent;
            if (oldValue !== newValue) {
                element.classList.add('updated');
                setTimeout(() => {
                    element.classList.remove('updated');
                }, 500);
            }
            element.textContent = newValue;
        };

        animateUpdate(document.getElementById("p1_damage"), maxSaXon.toLocaleString());
        animateUpdate(document.getElementById("p2_damage"), maxDevil.toLocaleString());
        
        animateUpdate(document.getElementById("p1_avg_damage"), avgSaXonDamage.toLocaleString());
        animateUpdate(document.getElementById("p2_avg_damage"), avgDevilDamage.toLocaleString());
        
        document.getElementById("p1_best_tank").textContent = saXonBestTank;
        document.getElementById("p2_best_tank").textContent = devilBestTank;
        
        animateUpdate(document.getElementById("p1_total_frags"), saXonTotalFrags.toLocaleString());
        animateUpdate(document.getElementById("p2_total_frags"), devilTotalFrags.toLocaleString());
        
        animateUpdate(document.getElementById("total_battles"), totalBattles.toLocaleString());
        animateUpdate(document.getElementById("win_rate"), `${winRate}%`);
        animateUpdate(document.getElementById("total_damage"), totalDamage.toLocaleString());
        animateUpdate(document.getElementById("total_platoon_frags"), totalFrags.toLocaleString());

        // Determine winner
        document.getElementById("p1").classList.remove("winner");
        document.getElementById("p2").classList.remove("winner");

        if (maxSaXon > maxDevil) {
            document.getElementById("p1").classList.add("winner");
        } else if (maxDevil > maxSaXon) {
            document.getElementById("p2").classList.add("winner");
        } else if (maxSaXon > 0 && maxSaXon === maxDevil) {
            // Tie - both get winner class
            document.getElementById("p1").classList.add("winner");
            document.getElementById("p2").classList.add("winner");
        }
    } catch (error) {
        console.error('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö:', error);
    }
}

// Initial load
loadData();

// Auto-refresh every 30 seconds
setInterval(loadData, 30000);
</script>

</body>
</html>
